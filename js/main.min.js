google.load("visualization","1",{packages:["corechart"],language:"ja"});google.setOnLoadCallback(chart_this);function chart_this(){$.getJSON("js/employees.json",function(c){employee_data=c;array_data=[];sorted_for_total=_.sortBy(employee_data,function(d){return d.employees}).reverse();$.each(sorted_for_total,function(d,e){console.log(e);array_data.push([e.short_name,e.employees,""+e.name+" employees: "+e.employees.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")])});var c=new google.visualization.DataTable();c.addColumn("string","Department");c.addColumn("number","Employees");c.addColumn({type:"string",role:"tooltip"});c.addRows(array_data);var a={title:"Total Employees (Logarithmic Scale)",vAxis:{title:"Department",titleTextStyle:{color:"black"}},height:800,hAxis:{logScale:true},colors:["slategray"]};var b=new google.visualization.BarChart(document.getElementById("employees_chart"));b.draw(c,a);$('[data-spy="scroll"]').each(function(){var d=$(this).scrollspy("refresh")})})}function workingDaysBetweenDates(b,g){if(g<b){return 0}var a=86400*1000;b.setHours(0,0,0,1);g.setHours(23,59,59,999);var f=g-b;var h=Math.ceil(f/a);var e=Math.floor(h/7);var h=h-(e*2);var d=b.getDay();var c=g.getDay();if(d-c>1){h=h-2}if(d==0&&c!=6){h=h-1}if(c==6&&d!=0){h=h-1}return h}function getHoursLost(){var a=new Date("October 01, 2013 00:00:00");var c=new Date();var b=new Date();b.setDate(b.getDate()-1);if((c.getDay()+1)%7<2){hours_lost=(workingDaysBetweenDates(a,b))*6400000}else{hours_lost=(workingDaysBetweenDates(a,b)-days)*6400000+Math.floor((time_passed*800000)/10800)}return hours_lost};